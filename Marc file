this code comes from marc
